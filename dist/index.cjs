'use strict';var pgCore=require('drizzle-orm/pg-core'),cuid2=require('@paralleldrive/cuid2'),drizzleOrm=require('drizzle-orm');var N=cuid2.init({length:8}),r=()=>new Date;var D=pgCore.pgEnum("account_role_enum",["admin","mamet","mentor","user","guest"]),c=pgCore.pgTable("account",{id:pgCore.text("id").primaryKey(),nim:pgCore.text("nim").notNull().unique(),password:pgCore.text("password").notNull(),role:D("role").default("user").notNull(),createdAt:pgCore.timestamp("created_at").defaultNow(),updatedAt:pgCore.timestamp("updated_at").$onUpdate(r)}),G=drizzleOrm.relations(c,({one:e})=>({user:e(n)}));var n=pgCore.pgTable("user",{id:pgCore.text("id").primaryKey().references(()=>c.id),nim:pgCore.text("nim").notNull().unique(),email:pgCore.text("email").unique(),fullName:pgCore.text("full_name"),birthDate:pgCore.date("birth_date"),phoneNumber:pgCore.text("phone_number"),idLine:pgCore.text("id_line"),idDiscord:pgCore.text("id_discord"),idInstagram:pgCore.text("id_instagram"),fakultas:pgCore.text("fakultas"),prodi:pgCore.text("prodi"),kelompok:pgCore.text("kelompok"),createdAt:pgCore.timestamp("created_at").defaultNow(),updatedAt:pgCore.timestamp("updated_at").$onUpdate(r)});var T=pgCore.pgEnum("media_bucket_enum",["core","oskm","dikpus","profile","submission-dikpus","submission-oskm","other"]),Z=pgCore.pgTable("media",{id:pgCore.text("id").primaryKey().$defaultFn(N),creatorId:pgCore.text("creator_id").references(()=>n.id,{onDelete:"cascade"}).notNull(),name:pgCore.text("name").unique().notNull(),bucket:T("bucket").notNull().default("other"),type:pgCore.text("type").notNull(),url:pgCore.text("url").notNull(),updatedAt:pgCore.timestamp("updated_at",{withTimezone:true}).notNull().$onUpdate(r),createdAt:pgCore.timestamp("created_at",{withTimezone:true}).notNull().defaultNow()});var $=pgCore.pgEnum("user_stage_progress_enum",["completed","in_progress","locked"]),m=pgCore.pgTable("stage",{id:pgCore.serial("id").primaryKey(),stageNumber:pgCore.integer("stage_number").notNull(),title:pgCore.text("title").notNull(),description:pgCore.text("description"),availableDate:pgCore.timestamp("available_date",{mode:"date",withTimezone:true}),createdAt:pgCore.timestamp("created_at").defaultNow(),updatedAt:pgCore.timestamp("updated_at").$onUpdate(r)}),U=pgCore.pgTable("user_stage_progress",{id:pgCore.text("id").primaryKey(),userId:pgCore.text("user_id").references(()=>n.id,{onDelete:"cascade"}),stageId:pgCore.serial("stage_id").references(()=>m.id,{onDelete:"cascade"}),status:$("status").default("locked").notNull(),score:pgCore.integer("score"),completedAt:pgCore.timestamp("completed_at")},e=>[pgCore.unique("user_stage_unique").on(e.userId,e.stageId)]),g=pgCore.pgTable("material",{id:pgCore.serial("id").primaryKey(),stageId:pgCore.serial("stage_id").references(()=>m.id,{onDelete:"cascade"}),profile:pgCore.text("profile")}),P=pgCore.pgTable("dialog",{id:pgCore.serial("id").primaryKey(),materialId:pgCore.serial("material_id").references(()=>g.id,{onDelete:"cascade"}),content:pgCore.text("content"),order:pgCore.integer("order").notNull()}),f=pgCore.pgTable("quiz",{id:pgCore.serial("id").primaryKey(),stageId:pgCore.serial("stage_id").references(()=>m.id,{onDelete:"cascade"})}),_=pgCore.pgTable("question",{id:pgCore.serial("id").primaryKey(),quizId:pgCore.serial("quiz_id").references(()=>f.id,{onDelete:"cascade"}),question:pgCore.text("question").notNull(),order:pgCore.integer("order").notNull()}),v=pgCore.pgTable("answer_option",{id:pgCore.serial("id").primaryKey(),questionId:pgCore.serial("question_id").references(()=>_.id),option:pgCore.text("option").notNull(),optionStatus:pgCore.boolean("option_status").notNull()}),ae=drizzleOrm.relations(m,({many:e})=>({userStageProgresses:e(U),materials:e(g),quizzes:e(f)})),ne=drizzleOrm.relations(f,({many:e})=>({questions:e(_)})),se=drizzleOrm.relations(_,({many:e})=>({answerOptions:e(v)})),de=drizzleOrm.relations(g,({many:e})=>({dialogs:e(P)}));exports.account=c;exports.accountRelation=G;exports.accountRoleEnum=D;exports.answerOption=v;exports.dialog=P;exports.material=g;exports.materialRelation=de;exports.media=Z;exports.mediaBucketEnum=T;exports.question=_;exports.questionRelation=se;exports.quiz=f;exports.quizRelation=ne;exports.stage=m;exports.stageRelation=ae;exports.user=n;exports.userStageProgress=U;exports.userStageProgressStatusEnum=$;