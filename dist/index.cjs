'use strict';var pgCore=require('drizzle-orm/pg-core'),cuid2=require('@paralleldrive/cuid2'),drizzleOrm=require('drizzle-orm');var z=cuid2.init({length:8}),a=()=>new Date;var O=pgCore.pgEnum("account_role_enum",["admin","mamet","mentor","user","guest"]),m=pgCore.pgTable("account",{id:pgCore.text("id").primaryKey(),nim:pgCore.text("nim").notNull().unique(),password:pgCore.text("password").notNull(),role:O("role").default("user").notNull(),createdAt:pgCore.timestamp("created_at").defaultNow(),updatedAt:pgCore.timestamp("updated_at").$onUpdate(a)}),D=pgCore.pgTable("reset_password_token",{id:pgCore.text("id").primaryKey().references(()=>m.id),token:pgCore.text("token"),tokenExpiration:pgCore.timestamp("token_expiration")}),te=drizzleOrm.relations(m,({one:e})=>({user:e(r,{fields:[m.id],references:[r.id]}),resetPasswordToken:e(D,{fields:[m.id],references:[D.id]})}));var r=pgCore.pgTable("user",{id:pgCore.text("id").primaryKey().references(()=>m.id),nim:pgCore.text("nim").notNull().unique(),email:pgCore.text("email").unique(),fullName:pgCore.text("full_name"),birthDate:pgCore.date("birth_date"),phoneNumber:pgCore.text("phone_number"),idLine:pgCore.text("id_line"),idDiscord:pgCore.text("id_discord"),idInstagram:pgCore.text("id_instagram"),fakultas:pgCore.text("fakultas"),prodi:pgCore.text("prodi"),kelompok:pgCore.text("kelompok"),createdAt:pgCore.timestamp("created_at").defaultNow(),updatedAt:pgCore.timestamp("updated_at").$onUpdate(a)});var L=pgCore.pgEnum("media_bucket_enum",["core","oskm","dikpus","profile","submission-dikpus","submission-oskm","other"]),y=pgCore.pgTable("media",{id:pgCore.text("id").primaryKey().$defaultFn(z),creatorId:pgCore.text("creator_id").references(()=>r.id,{onDelete:"cascade"}).notNull(),name:pgCore.text("name").unique().notNull(),bucket:L("bucket").notNull().default("other"),type:pgCore.text("type").notNull(),url:pgCore.text("url").notNull(),updatedAt:pgCore.timestamp("updated_at",{withTimezone:true}).notNull().$onUpdate(a),createdAt:pgCore.timestamp("created_at",{withTimezone:true}).notNull().defaultNow()}),A=pgCore.pgTable("handbook",{mediaId:pgCore.text("media_id").primaryKey().references(()=>y.id),title:pgCore.text("title")}),pe=drizzleOrm.relations(y,({one:e})=>({handbook:e(A,{fields:[y.id],references:[A.mediaId]})}));var J=pgCore.pgEnum("user_stage_progress_enum",["completed","in_progress","locked"]),i=pgCore.pgTable("stage",{id:pgCore.serial("id").primaryKey(),stageNumber:pgCore.integer("stage_number").notNull(),title:pgCore.text("title").notNull(),description:pgCore.text("description"),availableDate:pgCore.timestamp("available_date",{mode:"date",withTimezone:true}),deadlineDate:pgCore.timestamp("deadline_date",{mode:"date",withTimezone:true}),quizWeight:pgCore.real("quiz_weight").default(1).notNull(),roleplayWeight:pgCore.real("roleplay_weight").default(0).notNull(),lgdWeight:pgCore.real("lgd_weight").default(0).notNull(),stageWeight:pgCore.real("stage_weight").default(0).notNull(),createdAt:pgCore.timestamp("created_at").defaultNow(),updatedAt:pgCore.timestamp("updated_at").$onUpdate(a)}),q=pgCore.pgTable("user_stage_progress",{id:pgCore.text("id").primaryKey(),userId:pgCore.text("user_id").references(()=>r.id,{onDelete:"cascade"}),stageId:pgCore.serial("stage_id").references(()=>i.id,{onDelete:"cascade"}),status:J("status").default("in_progress").notNull(),completedAt:pgCore.timestamp("completed_at"),quizScore:pgCore.integer("quiz_score"),roleplayScore:pgCore.integer("roleplay_score"),lgdScore:pgCore.integer("lgd_score"),updatedAt:pgCore.timestamp("updated_at").$onUpdate(a)},e=>[pgCore.unique("user_stage_unique").on(e.userId,e.stageId)]),g=pgCore.pgTable("material",{id:pgCore.serial("id").primaryKey(),stageId:pgCore.serial("stage_id").references(()=>i.id,{onDelete:"cascade"}),profile:pgCore.text("profile")}),h=pgCore.pgTable("dialog",{id:pgCore.serial("id").primaryKey(),materialId:pgCore.serial("material_id").references(()=>g.id,{onDelete:"cascade"}),content:pgCore.text("content"),order:pgCore.integer("order").notNull()}),_=pgCore.pgTable("quiz",{id:pgCore.serial("id").primaryKey(),stageId:pgCore.serial("stage_id").references(()=>i.id,{onDelete:"cascade"})}),u=pgCore.pgTable("question",{id:pgCore.serial("id").primaryKey(),quizId:pgCore.serial("quiz_id").references(()=>_.id,{onDelete:"cascade"}),question:pgCore.text("question").notNull(),order:pgCore.integer("order").notNull()}),b=pgCore.pgTable("answer_option",{id:pgCore.serial("id").primaryKey(),questionId:pgCore.serial("question_id").references(()=>u.id),option:pgCore.text("option").notNull(),optionStatus:pgCore.boolean("option_status").notNull()}),Ne=drizzleOrm.relations(i,({many:e})=>({userStageProgresses:e(q),materials:e(g),quizzes:e(_)})),ke=drizzleOrm.relations(q,({one:e})=>({stage:e(i,{fields:[q.stageId],references:[i.id]})})),xe=drizzleOrm.relations(_,({one:e,many:x})=>({questions:x(u),stage:e(i,{fields:[_.stageId],references:[i.id]})})),we=drizzleOrm.relations(u,({one:e})=>({quiz:e(_,{fields:[u.quizId],references:[_.id]})})),ye=drizzleOrm.relations(u,({many:e})=>({answerOptions:e(b)})),qe=drizzleOrm.relations(b,({one:e})=>({question:e(u,{fields:[b.questionId],references:[u.id]})})),he=drizzleOrm.relations(g,({one:e,many:x})=>({dialogs:x(h),stage:e(i,{fields:[g.stageId],references:[i.id]})})),be=drizzleOrm.relations(h,({one:e})=>({material:e(g,{fields:[h.materialId],references:[g.id]})}));var P=pgCore.pgTable("kelas",{id_kelas:pgCore.text("id_kelas").primaryKey(),kuota:pgCore.integer("kuota").notNull(),judul:pgCore.text("judul").notNull(),deskripsi:pgCore.text("deskripsi").notNull(),pembicara:pgCore.text("pembicara").notNull()}),Re=pgCore.pgTable("pemilihan_kelas",{user_id:pgCore.text("user_id").notNull().references(()=>r.id,{onDelete:"cascade"}),kelas_id:pgCore.text("kelas_id").notNull().references(()=>P.id_kelas,{onDelete:"cascade"}),waktu:pgCore.timestamp("waktu").defaultNow().notNull(),prioritas:pgCore.integer("prioritas").notNull()}),Te=pgCore.pgTable("peserta_kelas",{user_id:pgCore.text("user_id").notNull().references(()=>r.id,{onDelete:"cascade"}),kelas_id:pgCore.text("kelas_id").notNull().references(()=>P.id_kelas,{onDelete:"cascade"})});exports.account=m;exports.accountRelation=te;exports.accountRoleEnum=O;exports.answerOption=b;exports.answerOptionRelation=qe;exports.dialog=h;exports.dialogRelation=be;exports.handbook=A;exports.kelas=P;exports.material=g;exports.materialRelation=he;exports.media=y;exports.mediaBucketEnum=L;exports.mediaRelation=pe;exports.pemilihan_kelas=Re;exports.peserta_kelas=Te;exports.question=u;exports.questionRelation=ye;exports.questionsRelation=we;exports.quiz=_;exports.quizRelation=xe;exports.resetPasswordToken=D;exports.stage=i;exports.stageRelation=Ne;exports.user=r;exports.userStageProgress=q;exports.userStageProgressRelation=ke;exports.userStageProgressStatusEnum=J;