import {pgEnum,pgTable,timestamp,text,date,integer,serial,unique,boolean}from'drizzle-orm/pg-core';import {init}from'@paralleldrive/cuid2';import {relations}from'drizzle-orm';var w=init({length:8}),i=()=>new Date;var R=pgEnum("account_role_enum",["admin","mamet","mentor","user","guest"]),c=pgTable("account",{id:text("id").primaryKey(),nim:text("nim").notNull().unique(),password:text("password").notNull(),role:R("role").default("user").notNull(),createdAt:timestamp("created_at").defaultNow(),updatedAt:timestamp("updated_at").$onUpdate(i)}),H=relations(c,({one:e})=>({user:e(n,{fields:[c.id],references:[n.id]})}));var n=pgTable("user",{id:text("id").primaryKey().references(()=>c.id),nim:text("nim").notNull().unique(),email:text("email").unique(),fullName:text("full_name"),birthDate:date("birth_date"),phoneNumber:text("phone_number"),idLine:text("id_line"),idDiscord:text("id_discord"),idInstagram:text("id_instagram"),fakultas:text("fakultas"),prodi:text("prodi"),kelompok:text("kelompok"),createdAt:timestamp("created_at").defaultNow(),updatedAt:timestamp("updated_at").$onUpdate(i)});var $=pgEnum("media_bucket_enum",["core","oskm","dikpus","profile","submission-dikpus","submission-oskm","other"]),ee=pgTable("media",{id:text("id").primaryKey().$defaultFn(w),creatorId:text("creator_id").references(()=>n.id,{onDelete:"cascade"}).notNull(),name:text("name").unique().notNull(),bucket:$("bucket").notNull().default("other"),type:text("type").notNull(),url:text("url").notNull(),updatedAt:timestamp("updated_at",{withTimezone:true}).notNull().$onUpdate(i),createdAt:timestamp("created_at",{withTimezone:true}).notNull().defaultNow()});var v=pgEnum("user_stage_progress_enum",["completed","in_progress","locked"]),r=pgTable("stage",{id:serial("id").primaryKey(),stageNumber:integer("stage_number").notNull(),title:text("title").notNull(),description:text("description"),availableDate:timestamp("available_date",{mode:"date",withTimezone:true}),createdAt:timestamp("created_at").defaultNow(),updatedAt:timestamp("updated_at").$onUpdate(i)}),N=pgTable("user_stage_progress",{id:text("id").primaryKey(),userId:text("user_id").references(()=>n.id,{onDelete:"cascade"}),stageId:serial("stage_id").references(()=>r.id,{onDelete:"cascade"}),status:v("status").default("locked").notNull(),score:integer("score"),completedAt:timestamp("completed_at")},e=>[unique("user_stage_unique").on(e.userId,e.stageId)]),l=pgTable("material",{id:serial("id").primaryKey(),stageId:serial("stage_id").references(()=>r.id,{onDelete:"cascade"}),profile:text("profile")}),q=pgTable("dialog",{id:serial("id").primaryKey(),materialId:serial("material_id").references(()=>l.id,{onDelete:"cascade"}),content:text("content"),order:integer("order").notNull()}),p=pgTable("quiz",{id:serial("id").primaryKey(),stageId:serial("stage_id").references(()=>r.id,{onDelete:"cascade"})}),d=pgTable("question",{id:serial("id").primaryKey(),quizId:serial("quiz_id").references(()=>p.id,{onDelete:"cascade"}),question:text("question").notNull(),order:integer("order").notNull()}),y=pgTable("answer_option",{id:serial("id").primaryKey(),questionId:serial("question_id").references(()=>d.id),option:text("option").notNull(),optionStatus:boolean("option_status").notNull()}),se=relations(r,({many:e})=>({userStageProgresses:e(N),materials:e(l),quizzes:e(p)})),ne=relations(N,({one:e})=>({stage:e(r,{fields:[N.stageId],references:[r.id]})})),de=relations(p,({one:e,many:_})=>({questions:_(d),stage:e(r,{fields:[p.stageId],references:[r.id]})})),ue=relations(d,({one:e})=>({quiz:e(p,{fields:[d.quizId],references:[p.id]})})),le=relations(d,({many:e})=>({answerOptions:e(y)})),pe=relations(y,({one:e})=>({question:e(d,{fields:[y.questionId],references:[d.id]})})),me=relations(l,({one:e,many:_})=>({dialogs:_(q),stage:e(r,{fields:[l.stageId],references:[r.id]})})),ce=relations(q,({one:e})=>({material:e(l,{fields:[q.materialId],references:[l.id]})}));export{c as account,H as accountRelation,R as accountRoleEnum,y as answerOption,pe as answerOptionRelation,q as dialog,ce as dialogRelation,l as material,me as materialRelation,ee as media,$ as mediaBucketEnum,d as question,le as questionRelation,ue as questionsRelation,p as quiz,de as quizRelation,r as stage,se as stageRelation,n as user,N as userStageProgress,ne as userStageProgressRelation,v as userStageProgressStatusEnum};